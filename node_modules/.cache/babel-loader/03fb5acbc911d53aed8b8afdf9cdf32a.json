{"ast":null,"code":"\"use strict\";\n\nconst _ = require(\"lodash\");\nconst RELATIONSHIP_SCHEMA_PREFIX = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n\n/**\n * A relationship collection.\n * @ignore\n */\nclass Relationships {\n  /**\n   * Creates a new instance of _Relationships.\n   * @param {{}} node - The node.\n   */\n  constructor(node) {\n    this._init(node);\n    this._getStartingId();\n  }\n\n  /**\n   * Add a new relationship.\n   * @param {string} type - The type of relationship.\n   * @param {string} target - The target of the relationship.\n   * @param {string} [targetMode] - The target mode of the relationship.\n   * @returns {{}} The new relationship.\n   */\n  add(type, target, targetMode) {\n    const node = {\n      name: \"Relationship\",\n      attributes: {\n        Id: `rId${this._nextId++}`,\n        Type: `${RELATIONSHIP_SCHEMA_PREFIX}${type}`,\n        Target: target\n      }\n    };\n    if (targetMode) {\n      node.attributes.TargetMode = targetMode;\n    }\n    this._node.children.push(node);\n    return node;\n  }\n\n  /**\n   * Find a relationship by ID.\n   * @param {string} id - The relationship ID.\n   * @returns {{}|undefined} The matching relationship or undefined if not found.\n   */\n  findById(id) {\n    return _.find(this._node.children, node => node.attributes.Id === id);\n  }\n\n  /**\n   * Find a relationship by type.\n   * @param {string} type - The type to search for.\n   * @returns {{}|undefined} The matching relationship or undefined if not found.\n   */\n  findByType(type) {\n    return _.find(this._node.children, node => node.attributes.Type === `${RELATIONSHIP_SCHEMA_PREFIX}${type}`);\n  }\n\n  /**\n   * Convert the collection to an XML object.\n   * @returns {{}|undefined} The XML or undefined if empty.\n   */\n  toXml() {\n    if (!this._node.children.length) return;\n    return this._node;\n  }\n\n  /**\n   * Get the starting relationship ID to use for new relationships.\n   * @private\n   * @returns {undefined}\n   */\n  _getStartingId() {\n    this._nextId = 1;\n    this._node.children.forEach(node => {\n      const id = parseInt(node.attributes.Id.substr(3));\n      if (id >= this._nextId) this._nextId = id + 1;\n    });\n  }\n\n  /**\n   * Initialize the node.\n   * @param {{}} [node] - The relationships node.\n   * @private\n   * @returns {undefined}\n   */\n  _init(node) {\n    if (!node) node = {\n      name: \"Relationships\",\n      attributes: {\n        xmlns: \"http://schemas.openxmlformats.org/package/2006/relationships\"\n      },\n      children: []\n    };\n    this._node = node;\n  }\n}\nmodule.exports = Relationships;\n\n/*\nxl/_rels/workbook.xml.rels\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n    <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>\n    <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>\n    <Relationship Id=\"rId5\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain\" Target=\"calcChain.xml\"/>\n    <Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>\n</Relationships>\n*/","map":{"version":3,"names":["_","require","RELATIONSHIP_SCHEMA_PREFIX","Relationships","constructor","node","_init","_getStartingId","add","type","target","targetMode","name","attributes","Id","_nextId","Type","Target","TargetMode","_node","children","push","findById","id","find","findByType","toXml","length","forEach","parseInt","substr","xmlns","module","exports"],"sources":["C:/w2d/personeria/personeria-ui/node_modules/xlsx-populate/lib/Relationships.js"],"sourcesContent":["\"use strict\";\n\nconst _ = require(\"lodash\");\n\nconst RELATIONSHIP_SCHEMA_PREFIX = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/\";\n\n/**\n * A relationship collection.\n * @ignore\n */\nclass Relationships {\n    /**\n     * Creates a new instance of _Relationships.\n     * @param {{}} node - The node.\n     */\n    constructor(node) {\n        this._init(node);\n        this._getStartingId();\n    }\n\n    /**\n     * Add a new relationship.\n     * @param {string} type - The type of relationship.\n     * @param {string} target - The target of the relationship.\n     * @param {string} [targetMode] - The target mode of the relationship.\n     * @returns {{}} The new relationship.\n     */\n    add(type, target, targetMode) {\n        const node = {\n            name: \"Relationship\",\n            attributes: {\n                Id: `rId${this._nextId++}`,\n                Type: `${RELATIONSHIP_SCHEMA_PREFIX}${type}`,\n                Target: target\n            }\n        };\n\n        if (targetMode) {\n            node.attributes.TargetMode = targetMode;\n        }\n\n        this._node.children.push(node);\n        return node;\n    }\n\n    /**\n     * Find a relationship by ID.\n     * @param {string} id - The relationship ID.\n     * @returns {{}|undefined} The matching relationship or undefined if not found.\n     */\n    findById(id) {\n        return _.find(this._node.children, node => node.attributes.Id === id);\n    }\n\n    /**\n     * Find a relationship by type.\n     * @param {string} type - The type to search for.\n     * @returns {{}|undefined} The matching relationship or undefined if not found.\n     */\n    findByType(type) {\n        return _.find(this._node.children, node => node.attributes.Type === `${RELATIONSHIP_SCHEMA_PREFIX}${type}`);\n    }\n\n    /**\n     * Convert the collection to an XML object.\n     * @returns {{}|undefined} The XML or undefined if empty.\n     */\n    toXml() {\n        if (!this._node.children.length) return;\n        return this._node;\n    }\n\n    /**\n     * Get the starting relationship ID to use for new relationships.\n     * @private\n     * @returns {undefined}\n     */\n    _getStartingId() {\n        this._nextId = 1;\n        this._node.children.forEach(node => {\n            const id = parseInt(node.attributes.Id.substr(3));\n            if (id >= this._nextId) this._nextId = id + 1;\n        });\n    }\n\n    /**\n     * Initialize the node.\n     * @param {{}} [node] - The relationships node.\n     * @private\n     * @returns {undefined}\n     */\n    _init(node) {\n        if (!node) node = {\n            name: \"Relationships\",\n            attributes: {\n                xmlns: \"http://schemas.openxmlformats.org/package/2006/relationships\"\n            },\n            children: []\n        };\n\n        this._node = node;\n    }\n}\n\nmodule.exports = Relationships;\n\n/*\nxl/_rels/workbook.xml.rels\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n    <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>\n    <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>\n    <Relationship Id=\"rId5\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain\" Target=\"calcChain.xml\"/>\n    <Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>\n</Relationships>\n*/\n\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAE3B,MAAMC,0BAA0B,GAAG,sEAAsE;;AAEzG;AACA;AACA;AACA;AACA,MAAMC,aAAa,CAAC;EAChB;AACJ;AACA;AACA;EACIC,WAAW,CAACC,IAAI,EAAE;IACd,IAAI,CAACC,KAAK,CAACD,IAAI,CAAC;IAChB,IAAI,CAACE,cAAc,EAAE;EACzB;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,GAAG,CAACC,IAAI,EAAEC,MAAM,EAAEC,UAAU,EAAE;IAC1B,MAAMN,IAAI,GAAG;MACTO,IAAI,EAAE,cAAc;MACpBC,UAAU,EAAE;QACRC,EAAE,EAAG,MAAK,IAAI,CAACC,OAAO,EAAG,EAAC;QAC1BC,IAAI,EAAG,GAAEd,0BAA2B,GAAEO,IAAK,EAAC;QAC5CQ,MAAM,EAAEP;MACZ;IACJ,CAAC;IAED,IAAIC,UAAU,EAAE;MACZN,IAAI,CAACQ,UAAU,CAACK,UAAU,GAAGP,UAAU;IAC3C;IAEA,IAAI,CAACQ,KAAK,CAACC,QAAQ,CAACC,IAAI,CAAChB,IAAI,CAAC;IAC9B,OAAOA,IAAI;EACf;;EAEA;AACJ;AACA;AACA;AACA;EACIiB,QAAQ,CAACC,EAAE,EAAE;IACT,OAAOvB,CAAC,CAACwB,IAAI,CAAC,IAAI,CAACL,KAAK,CAACC,QAAQ,EAAEf,IAAI,IAAIA,IAAI,CAACQ,UAAU,CAACC,EAAE,KAAKS,EAAE,CAAC;EACzE;;EAEA;AACJ;AACA;AACA;AACA;EACIE,UAAU,CAAChB,IAAI,EAAE;IACb,OAAOT,CAAC,CAACwB,IAAI,CAAC,IAAI,CAACL,KAAK,CAACC,QAAQ,EAAEf,IAAI,IAAIA,IAAI,CAACQ,UAAU,CAACG,IAAI,KAAM,GAAEd,0BAA2B,GAAEO,IAAK,EAAC,CAAC;EAC/G;;EAEA;AACJ;AACA;AACA;EACIiB,KAAK,GAAG;IACJ,IAAI,CAAC,IAAI,CAACP,KAAK,CAACC,QAAQ,CAACO,MAAM,EAAE;IACjC,OAAO,IAAI,CAACR,KAAK;EACrB;;EAEA;AACJ;AACA;AACA;AACA;EACIZ,cAAc,GAAG;IACb,IAAI,CAACQ,OAAO,GAAG,CAAC;IAChB,IAAI,CAACI,KAAK,CAACC,QAAQ,CAACQ,OAAO,CAACvB,IAAI,IAAI;MAChC,MAAMkB,EAAE,GAAGM,QAAQ,CAACxB,IAAI,CAACQ,UAAU,CAACC,EAAE,CAACgB,MAAM,CAAC,CAAC,CAAC,CAAC;MACjD,IAAIP,EAAE,IAAI,IAAI,CAACR,OAAO,EAAE,IAAI,CAACA,OAAO,GAAGQ,EAAE,GAAG,CAAC;IACjD,CAAC,CAAC;EACN;;EAEA;AACJ;AACA;AACA;AACA;AACA;EACIjB,KAAK,CAACD,IAAI,EAAE;IACR,IAAI,CAACA,IAAI,EAAEA,IAAI,GAAG;MACdO,IAAI,EAAE,eAAe;MACrBC,UAAU,EAAE;QACRkB,KAAK,EAAE;MACX,CAAC;MACDX,QAAQ,EAAE;IACd,CAAC;IAED,IAAI,CAACD,KAAK,GAAGd,IAAI;EACrB;AACJ;AAEA2B,MAAM,CAACC,OAAO,GAAG9B,aAAa;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"script"}